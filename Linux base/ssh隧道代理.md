# ssh隧道原理

```c
ssh -L 9906:10.1.0.2:3306 root@10.1.0.2

上述命令表示从本机(ServerA)建立一个到ServerB(10.1.0.2)的ssh隧道，使用本地端口转发模式，监听ServerA本地(回环接口)的9906端口，访问本机的9906端口时，通讯数据将会被转发到ServerB(10.1.0.2)的3306端口。
```

# ssh隧道使用

```c
本地隧道:
    1.创建ssh隧道
    ~]# ssh -L 9906:10.1.0.2:3306 root@10.1.0.2     # 需要输入远程机器root账号密码,且会登录到目标机器，退出后通道就会关闭

    2.后台运行隧道
    ~]# ssh -f -N -L 9906:10.1.0.2:3306 root@10.1.0.2	# 后台运行隧道，默认是监听本地回环接口

    3.指定IP运行隧道
    ~]# ssh -f -N -L 10.1.0.1:9906:10.1.0.2:3306 root@10.1.0.2

    4.所有网卡都监听端口
    ~]# ssh -f -N -L -g 10.1.0.1:9906:10.1.0.2:3306 root@10.1.0.2

远程隧道:
	~]# ssh -f -N -R forwardingPort:targetIP:targetPort user@sshServerIP	# 加上-R参数
        
本地隧道与远程隧道的区别:
	本地隧道：
		本地主机：隧道的一头，本地主机既是ssh客户端，又是应用客户端
		远程主机：隧道的另一头，远程主机既是ssh服务端，又是应用服务端
		隧道创建以后，转发端口监听在本地主机中，即监听在ssh客户端主机中。

    远程隧道：
        本地主机：隧道的一头，本地主机既是ssh客户端，又是应用服务端
		远程主机：隧道的另一头，远程主机既是ssh服务端，又是应用客户端
		隧道创建以后，转发端口监听在远程主机中，即监听在ssh服务端主机中。
```

